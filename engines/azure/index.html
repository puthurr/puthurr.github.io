


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Ability to get more meaninful text out of common OCR outputs.">
      
      
      
        <meta name="author" content="Nicolas Uthurriague">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-5.1.6">
    
    
      
        <title>Azure OCR - OCR Layout Helper</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.4b9ffd7b.min.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/palette.b79bcd20.min.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
      <link rel="stylesheet" href="../../extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#azure-optical-character-recognition-ocr" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="../.." title="OCR Layout Helper" class="md-header-nav__button md-logo" aria-label="OCR Layout Helper">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            OCR Layout Helper
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Azure OCR
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/puthurr/ocrlayout/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="OCR Layout Helper" class="md-nav__button md-logo" aria-label="OCR Layout Helper">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    OCR Layout Helper
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/puthurr/ocrlayout/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      OCR Engines
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="OCR Engines" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        OCR Engines
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Azure OCR
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="Azure OCR" class="md-nav__link md-nav__link--active">
      Azure OCR
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#azure-computer-vision-cognitive-services-computer-vision-documentation" class="md-nav__link">
    Azure Computer Vision Cognitive Services Computer Vision Documentation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#azure-computer-vision-python-examples" class="md-nav__link">
    Azure Computer Vision Python Examples
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#azure-bboxhelper-integration" class="md-nav__link">
    Azure BBoxHelper Integration
  </a>
  
    <nav class="md-nav" aria-label="Azure BBoxHelper Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behind-the-scene" class="md-nav__link">
    Behind the scene...
  </a>
  
    <nav class="md-nav" aria-label="Behind the scene...">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#snippet-of-the-bboxhelperpy-to-process-an-azure-ocr-response" class="md-nav__link">
    Snippet of the bboxhelper.py to process an Azure OCR response
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reading-the-response-from-a-file" class="md-nav__link">
    Reading the response from a file
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../google/" title="Google OCR" class="md-nav__link">
      Google OCR
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../aws/" title="AWS OCR" class="md-nav__link">
      AWS OCR
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../sorting/" title="Sorting Strategy" class="md-nav__link">
      Sorting Strategy
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Examples
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Examples" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/infography1/" title="Simple Infographic" class="md-nav__link">
      Simple Infographic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/infography2/" title="Complex Infographic" class="md-nav__link">
      Complex Infographic
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/scan1/" title="Simple page Layout" class="md-nav__link">
      Simple page Layout
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/scan6/" title="Common page Layout" class="md-nav__link">
      Common page Layout
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../examples/scan2/" title="Complex page Layout" class="md-nav__link">
      Complex page Layout
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../known-limitations/" title="Known Limitations" class="md-nav__link">
      Known Limitations
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      About
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="About" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../about/license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#azure-computer-vision-cognitive-services-computer-vision-documentation" class="md-nav__link">
    Azure Computer Vision Cognitive Services Computer Vision Documentation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#azure-computer-vision-python-examples" class="md-nav__link">
    Azure Computer Vision Python Examples
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#azure-bboxhelper-integration" class="md-nav__link">
    Azure BBoxHelper Integration
  </a>
  
    <nav class="md-nav" aria-label="Azure BBoxHelper Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#behind-the-scene" class="md-nav__link">
    Behind the scene...
  </a>
  
    <nav class="md-nav" aria-label="Behind the scene...">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#snippet-of-the-bboxhelperpy-to-process-an-azure-ocr-response" class="md-nav__link">
    Snippet of the bboxhelper.py to process an Azure OCR response
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reading-the-response-from-a-file" class="md-nav__link">
    Reading the response from a file
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/puthurr/ocrlayout/blob/master/docs/engines/azure.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="azure-optical-character-recognition-ocr">Azure Optical Character Recognition (OCR)<a class="headerlink" href="#azure-optical-character-recognition-ocr" title="Permanent link">&para;</a></h1>
<p>BBOXHelper supports Azure Cognitive Services Computer Vision OCR &amp; Read API responses for text detection.</p>
<p>BBOXResponse class follows closely the Read API response data model.</p>
<blockquote>
<p>The Read API detects text content in an image using our latest recognition models and converts the identified text into a machine-readable character stream. It's optimized for text-heavy images (such as documents that have been digitally scanned) and for images with a lot of visual noise. It will determine which recognition model to use for each line of text, supporting images with both printed and handwritten text. The Read API executes asynchronously because larger documents can take several minutes to return a result.</p>
<p>The Read operation maintains the original line groupings of recognized words in its output. Each line comes with bounding box coordinates, and each word within the line also has its own coordinates. If a word was recognized with low confidence, that information is conveyed as well. </p>
</blockquote>
<p>About the OCR API </p>
<blockquote>
<p>The OCR API uses an older recognition model, supports only images, and executes synchronously, returning immediately with the detected text. It supports more languages than Read API.</p>
</blockquote>
<p>Make sure you understand the requirements/limitations of both APIs for your project. </p>
<h2 id="azure-computer-vision-cognitive-services-computer-vision-documentation">Azure Computer Vision Cognitive Services Computer Vision Documentation<a class="headerlink" href="#azure-computer-vision-cognitive-services-computer-vision-documentation" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="https://docs.microsoft.com/en-us/azure/cognitive-services/computer-vision/concept-recognizing-text#read-api">Computer Vision Read API</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/cognitive-services/computer-vision/concept-recognizing-text#input-requirements">Computer Vision Read API Image Requirements</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/cognitive-services/computer-vision/concept-recognizing-text#ocr-api">Computer Vision OCR API</a></li>
<li><a href="https://docs.microsoft.com/en-us/azure/cognitive-services/computer-vision/language-support#text-recognition">Text Recognition Language Support</a></li>
<li><a href="https://github.com/Azure/azure-sdk-for-python/tree/76a0d91c32a79561a7d5666e421908e7c4cffc6a/sdk/cognitiveservices/azure-cognitiveservices-vision-computervision">Computer Vision API Python SDK</a></li>
<li><a href="https://azure.github.io/azure-sdk-for-python/">Azure SDK for Python</a></li>
</ol>
<h2 id="azure-computer-vision-python-examples">Azure Computer Vision Python Examples<a class="headerlink" href="#azure-computer-vision-python-examples" title="Permanent link">&para;</a></h2>
<p>You can refer to this <a href="https://github.com/Azure-Samples/cognitive-services-python-sdk-samples/tree/master/samples/vision">examples</a> to learn about the Python sdk.</p>
<p><strong>Note</strong>: some examples are not current. Check the <a href="https://pypi.org/project/azure-cognitiveservices-vision-computervision/0.6.0/">Azure computer Vision Python SDK</a></p>
<h2 id="azure-bboxhelper-integration">Azure BBoxHelper Integration<a class="headerlink" href="#azure-bboxhelper-integration" title="Permanent link">&para;</a></h2>
<p>Import the below ocrlayout classes</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">ocrlayout.bboxhelper</span> <span class="kn">import</span> <span class="n">BBOXOCRResponse</span><span class="p">,</span><span class="n">BBoxHelper</span>
</code></pre></div>


<blockquote>
<p>Example of using the Azure CV python sdk and READ API. </p>
</blockquote>
<div class="codehilite"><pre><span></span><code><span class="n">azure_client</span> <span class="o">=</span> <span class="n">ComputerVisionClient</span><span class="p">(</span>
    <span class="n">endpoint</span><span class="o">=</span><span class="s2">&quot;https://&quot;</span> <span class="o">+</span> <span class="n">COMPUTERVISION_LOCATION</span> <span class="o">+</span> <span class="s2">&quot;.api.cognitive.microsoft.com/&quot;</span><span class="p">,</span>
    <span class="n">credentials</span><span class="o">=</span><span class="n">CognitiveServicesCredentials</span><span class="p">(</span><span class="n">SUBSCRIPTION_KEY_ENV_NAME</span><span class="p">)</span>
<span class="p">)</span>
<span class="o">...</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">IMAGES_FOLDER</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">image_stream</span><span class="p">:</span>
    <span class="n">job</span> <span class="o">=</span> <span class="n">azure_client</span><span class="o">.</span><span class="n">read_in_stream</span><span class="p">(</span>
        <span class="n">image</span><span class="o">=</span><span class="n">image_stream</span><span class="p">,</span>
        <span class="n">raw</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
<span class="n">operation_id</span> <span class="o">=</span> <span class="n">job</span><span class="o">.</span><span class="n">headers</span><span class="p">[</span><span class="s1">&#39;Operation-Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">image_analysis</span> <span class="o">=</span> <span class="n">azure_client</span><span class="o">.</span><span class="n">get_read_result</span><span class="p">(</span><span class="n">operation_id</span><span class="p">,</span><span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">while</span> <span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">(</span><span class="n">image_analysis</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">status</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;notstarted&#39;</span><span class="p">,</span> <span class="s1">&#39;running&#39;</span><span class="p">]:</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">image_analysis</span> <span class="o">=</span> <span class="n">azure_client</span><span class="o">.</span><span class="n">get_read_result</span><span class="p">(</span><span class="n">operation_id</span><span class="o">=</span><span class="n">operation_id</span><span class="p">,</span><span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Job completion is: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">image_analysis</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">status</span><span class="p">))</span>    
</code></pre></div>


<p>Capture the READ API response object as string.</p>
<div class="codehilite"><pre><span></span><code><span class="n">ocrresponse</span><span class="o">=</span><span class="n">image_analysis</span><span class="o">.</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
</code></pre></div>


<p>Pass it to the BBoxHelper processing method <strong>processAzureOCRResponse()</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># Create BBOX OCR Response from Azure CV string response</span>
<span class="n">bboxresponse</span><span class="o">=</span><span class="n">BBoxHelper</span><span class="p">()</span><span class="o">.</span><span class="n">processAzureOCRResponse</span><span class="p">(</span><span class="n">ocrresponse</span><span class="p">)</span>
</code></pre></div>


<p>Print the resulting text</p>
<div class="codehilite"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">bboxresponse</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</code></pre></div>


<h3 id="behind-the-scene">Behind the scene...<a class="headerlink" href="#behind-the-scene" title="Permanent link">&para;</a></h3>
<p>Our BBoxHelper is fully compatible with Azure response model with pages/lines thus the parsing is pretty straighforward. 
The method <strong>processAzureOCRResponse()</strong> supports passing a string, JSON object or an existing BBOXOCRResponse.</p>
<h4 id="snippet-of-the-bboxhelperpy-to-process-an-azure-ocr-response">Snippet of the <strong>bboxhelper.py</strong> to process an Azure OCR response<a class="headerlink" href="#snippet-of-the-bboxhelperpy-to-process-an-azure-ocr-response" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><code><span class="k">class</span> <span class="nc">BBOXPageLayout</span><span class="p">():</span>
    <span class="c1">#...</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_azure</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">lines</span><span class="o">=</span><span class="p">[</span><span class="n">BBOXNormalizedLine</span><span class="o">.</span><span class="n">from_azure</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">line</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;lines&quot;</span><span class="p">])]</span> 
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">Id</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;page&quot;</span><span class="p">],</span><span class="n">ClockwiseOrientation</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;clockwiseOrientation&quot;</span><span class="p">],</span><span class="n">Width</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">],</span><span class="n">Height</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">],</span><span class="n">Unit</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;unit&quot;</span><span class="p">],</span><span class="n">Lines</span><span class="o">=</span><span class="n">lines</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">BBOXOCRResponse</span><span class="p">():</span>
    <span class="c1">#...</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_azure</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="n">pages</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">BBOXPageLayout</span><span class="o">.</span><span class="n">from_azure</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;recognitionResults&quot;</span><span class="p">]))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">],</span><span class="n">recognitionResults</span><span class="o">=</span><span class="n">pages</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">BBoxHelper</span><span class="p">():</span>

    <span class="k">def</span> <span class="nf">processAzureOCRResponse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">input</span><span class="p">,</span><span class="n">sortingAlgo</span><span class="o">=</span><span class="n">BBoxSort</span><span class="o">.</span><span class="n">contoursSort</span><span class="p">,</span><span class="n">boxSeparator</span><span class="p">:</span><span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; processAzureOCRResponse method</span>
<span class="sd">            Process an OCR Response input from Azure and returns a new BBox format OCR response.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#load the input json into a response object</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="n">response</span><span class="o">=</span><span class="n">BBOXOCRResponse</span><span class="o">.</span><span class="n">from_azure</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="nb">input</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
            <span class="n">response</span><span class="o">=</span><span class="n">BBOXOCRResponse</span><span class="o">.</span><span class="n">from_azure</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="n">BBOXOCRResponse</span><span class="p">):</span>
            <span class="n">response</span><span class="o">=</span><span class="nb">input</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__processOCRResponse</span><span class="p">(</span><span class="n">response</span><span class="p">,</span><span class="n">sortingAlgo</span><span class="p">,</span><span class="n">boxSeparator</span><span class="p">)</span>        
</code></pre></div>


<h3 id="reading-the-response-from-a-file">Reading the response from a file<a class="headerlink" href="#reading-the-response-from-a-file" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># Use local OCR cached response when available</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">RESULTS_FOLDER</span><span class="p">,</span> <span class="n">imgname</span><span class="o">+</span><span class="s2">&quot;.azure.read.json&quot;</span><span class="p">),</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">cachefile</span><span class="p">:</span>
    <span class="n">ocrresponse</span> <span class="o">=</span> <span class="n">cachefile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1"># Create BBOX OCR Response from Azure CV string response</span>
<span class="n">bboxresponse</span><span class="o">=</span><span class="n">BBoxHelper</span><span class="p">()</span><span class="o">.</span><span class="n">processAzureOCRResponse</span><span class="p">(</span><span class="n">ocrresponse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bboxresponse</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</code></pre></div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../getting-started/" title="Getting Started" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Getting Started
              </div>
            </div>
          </a>
        
        
          <a href="../google/" title="Google OCR" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Google OCR
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.a0c4167b.min.js"></script>
      <script src="../../assets/javascripts/bundle.fb26dd1d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.37585f48.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>